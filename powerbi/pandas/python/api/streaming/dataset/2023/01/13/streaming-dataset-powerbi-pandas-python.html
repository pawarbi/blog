<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Streaming Data From A File To Power BI Streaming Dataset Using Python | Sandeep Pawar</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Streaming Data From A File To Power BI Streaming Dataset Using Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Create streaming dataset based on an existing file using Python. Super handy for POCs." />
<meta property="og:description" content="Create streaming dataset based on an existing file using Python. Super handy for POCs." />
<link rel="canonical" href="https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html" />
<meta property="og:url" content="https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html" />
<meta property="og:site_name" content="Sandeep Pawar" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-13T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"Create streaming dataset based on an existing file using Python. Super handy for POCs.","@type":"BlogPosting","url":"https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html","dateModified":"2023-01-13T00:00:00-06:00","datePublished":"2023-01-13T00:00:00-06:00","headline":"Streaming Data From A File To Power BI Streaming Dataset Using Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pawarbi.github.io/blog/feed.xml" title="Sandeep Pawar" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-164557532-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Streaming Data From A File To Power BI Streaming Dataset Using Python | Sandeep Pawar</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Streaming Data From A File To Power BI Streaming Dataset Using Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Create streaming dataset based on an existing file using Python. Super handy for POCs." />
<meta property="og:description" content="Create streaming dataset based on an existing file using Python. Super handy for POCs." />
<link rel="canonical" href="https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html" />
<meta property="og:url" content="https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html" />
<meta property="og:site_name" content="Sandeep Pawar" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-13T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"Create streaming dataset based on an existing file using Python. Super handy for POCs.","@type":"BlogPosting","url":"https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html","dateModified":"2023-01-13T00:00:00-06:00","datePublished":"2023-01-13T00:00:00-06:00","headline":"Streaming Data From A File To Power BI Streaming Dataset Using Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://pawarbi.github.io/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://pawarbi.github.io/blog/feed.xml" title="Sandeep Pawar" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-164557532-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Sandeep Pawar</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Streaming Data From A File To Power BI Streaming Dataset Using Python</h1><p class="page-description">Create streaming dataset based on an existing file using Python. Super handy for POCs.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-01-13T00:00:00-06:00" itemprop="datePublished">
        Jan 13, 2023
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#powerbi">powerbi</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#pandas">pandas</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#api">api</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#streaming">streaming</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#dataset">dataset</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/pawarbi/blog/tree/master/_notebooks/2023-01-13-streaming-dataset-powerbi-pandas-python.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/pawarbi/blog/master?filepath=_notebooks%2F2023-01-13-streaming-dataset-powerbi-pandas-python.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/pawarbi/blog/blob/master/_notebooks/2023-01-13-streaming-dataset-powerbi-pandas-python.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Streaming-Dataset">Streaming Dataset </a>
<ul>
<li class="toc-entry toc-h5"><a href="#Create-A-Streaming-dataset">Create A Streaming dataset </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Python-Script">Python Script </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Data">Data </a></li>
<li class="toc-entry toc-h4"><a href="#Test">Test </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Streaming-Rows">Streaming Rows </a>
<ul>
<li class="toc-entry toc-h4"><a href="#To-stream-the-entire-file">To stream the entire file </a></li>
<li class="toc-entry toc-h3"><a href="#To-randomly-stream-x%-of-the-data">To randomly stream x% of the data </a></li>
<li class="toc-entry toc-h3"><a href="#Resources">Resources </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-01-13-streaming-dataset-powerbi-pandas-python.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Streaming-Dataset">
<a class="anchor" href="#Streaming-Dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Streaming Dataset<a class="anchor-link" href="#Streaming-Dataset"> </a>
</h2>
<p>It's easy to create a streaming dataset in Power BI for real-time applications. You do not need a premium capacity. To keep the blog short, I am going to assume you already know what is a streaming dataset and how it differs from import/DQ. If you are not familiar, <a href="https://learn.microsoft.com/en-us/power-bi/connect-data/service-real-time-streaming">this documentation</a> will help.</p>
<p>Imagine you are creating a POC and would like to develop the real-time dashboard, report or just want to show to your stakeholders what the solution would loook like, you will need data to stream to Power BI service. You can create Azure Event Hub, Streaming Analytics. But in this blog, I will show you how you can stream data from an existing file. I will also include a link below in the resources for a few sample datasets you can use depending on the use case.</p>
<p>You will need a Python IDE with pandas installed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/msedge_umtOfdekx5.gif" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Create-A-Streaming-dataset">
<a class="anchor" href="#Create-A-Streaming-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create A Streaming dataset<a class="anchor-link" href="#Create-A-Streaming-dataset"> </a>
</h5>
<p>First create a streaming dataset in Power BI service using the API method.
<img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/KP9NMM8b4g.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I will be using <a href="https://github.com/reisanar/datasets/blob/master/eBayAuctions.csv">this dataset</a> for my example. Note the columns and column types from your data and create the dataset in Power BI service accorindgly. 
<img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/msedge_dyzzbjo5kF.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note the API endpoint:</p>
<p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/msedge_imlnDaqdcW.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's it. We are now ready to stream the data to Power BI service.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python-Script">
<a class="anchor" href="#Python-Script" aria-hidden="true"><span class="octicon octicon-link"></span></a>Python Script<a class="anchor-link" href="#Python-Script"> </a>
</h2>
<p>I will import the data using pandas.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>


<span class="k">class</span> <span class="nc">StreamToPowerBI</span><span class="p">:</span>
    
    <span class="sd">"""</span>

<span class="sd">    Class to stream data to Power BI Streaming dataset</span>
<span class="sd">    --------------------------------------------------</span>
<span class="sd">    Example:</span>

<span class="sd">     - endpoint :  API ednpoint, e.g. "https://api.powerbi.com/beta/&lt;ws_id&gt;/datasets/&lt;dataset_id&gt;/rows?key=&lt;___key___&gt;"</span>
<span class="sd">     - data     :  Data in dictionary e.g. {"id":1, "Value":2.33, "Color":"Red"} </span>
<span class="sd">                   Number of columns, column names and column type must match with Power BI.</span>
<span class="sd">     - delay    :  Delay in seconds in sending the data to Power BI. e.g. if delay is 3, data will be sent every 3 seconds.</span>
<span class="sd">                   default value is 2 seconds. To overwrite, use the wait() method</span>
<span class="sd">                   </span>
<span class="sd">                   </span>
<span class="sd">     example:      To stream data to the specified endpoint with 5 s delay</span>
<span class="sd">                   StreamToPowerBI(endpoint,data).wait(5).post_data()              </span>
<span class="sd"> </span>
<span class="sd">    """</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="n">delay</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span>   
        
    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">''' Delay in seconds to stream the data '''</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="c1"># default value is 2 seconds</span>
            <span class="n">other</span> <span class="o">=</span> <span class="mi">2</span> 
        <span class="n">sleep</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>    
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">post_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">''' Use post method send the data to Power BI'''</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">endpoint</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">json</span> <span class="o">=</span> <span class="n">payload</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Failed ! Check endpoint, data"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Data passed is not a dictionary. It should be in the format </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span>
    
    
    
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Data">
<a class="anchor" href="#Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data<a class="anchor-link" href="#Data"> </a>
</h4>
<p>Import the data using pandas or any other library (spark, polars etc.). Be sure to make the numeric columns type <code>float</code> otherwise json serialization will fail. I am also removing null values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/reisanar/datasets/master/eBayAuctions.csv"</span><span class="p">,</span> 
                  <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">'Category'</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
                         <span class="s1">'currency'</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
                         <span class="s1">'sellerRating'</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                         <span class="s1">'Duration'</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                         <span class="s1">'ClosePrice'</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                         <span class="s1">'OpenPrice'</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                         <span class="s1">'Competitive?'</span><span class="p">:</span><span class="nb">float</span><span class="p">},</span>
                  <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">'Category'</span><span class="p">,</span><span class="s1">'currency'</span><span class="p">,</span><span class="s1">'sellerRating'</span><span class="p">,</span><span class="s1">'Duration'</span><span class="p">,</span><span class="s1">'ClosePrice'</span><span class="p">,</span><span class="s1">'OpenPrice'</span><span class="p">,</span><span class="s1">'Competitive?'</span><span class="p">])</span>
     <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Test">
<a class="anchor" href="#Test" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test<a class="anchor-link" href="#Test"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before streaming data from the whole file, let's first test using one data point. Note that in the orginal data, there is no timestamp, so I am adding the timestamp , i.e <code>DateTime</code> column, to the dictionary. In your case, you may not want to do that. comment it out if you want to stream the data as is.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">d</span><span class="p">[</span><span class="s1">'DateTime'</span><span class="p">]</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'Category': 'Music/Movie/Game',
 'currency': 'US',
 'sellerRating': 3249.0,
 'Duration': 5.0,
 'ClosePrice': 0.01,
 'OpenPrice': 0.01,
 'Competitive?': 0.0,
 'DateTime': '2023-01-13T13:44:05.740998'}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">endpoint</span> <span class="o">=</span> <span class="s2">"https://api.powerbi.com/beta/xxxxxxx/datasets/xxxxxxxxxx"</span>
<span class="n">StreamToPowerBI</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">post_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;Response [200]&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>Note that the API endpoint Power BI provides includes the key so never share the endpoint with anyone. If you do, they will be able to stream the data without any authentication !
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If the reponse returned is <code>&lt;Response [200]&gt;</code>, it was successful. We can now stream the more data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Streaming-Rows">
<a class="anchor" href="#Streaming-Rows" aria-hidden="true"><span class="octicon octicon-link"></span></a>Streaming Rows<a class="anchor-link" href="#Streaming-Rows"> </a>
</h2>
<p>To stream the rows, we will just iterate over the dataframe and send one row at a time with the specified delay.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="To-stream-the-entire-file">
<a class="anchor" href="#To-stream-the-entire-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>To stream the entire file<a class="anchor-link" href="#To-stream-the-entire-file"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">record</span><span class="p">])</span>
    
    <span class="c1">#including datetime is optional. If you do want it, make sure it's included in the streaming dataset defintion in Power BI service</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">'DateTime'</span><span class="p">]</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    
    <span class="n">StreamToPowerBI</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">post_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="To-randomly-stream-x%-of-the-data">
<a class="anchor" href="#To-randomly-stream-x%-of-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>To randomly stream x% of the data<a class="anchor-link" href="#To-randomly-stream-x%-of-the-data"> </a>
</h3>
<p>Remember the purpose here is POC so don't stream all the rows (read the dcoumentation for limtations). You can use below to randomly sample x % of the rows from the dataframe.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">x</span><span class="p">))):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">record</span><span class="p">])</span>
    
    <span class="c1">#including datetime is optional. If you do want it, make sure it's included in the streaming dataset defintion in Power BI service</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">'DateTime'</span><span class="p">]</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    
    <span class="n">StreamToPowerBI</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">post_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resources">
<a class="anchor" href="#Resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources<a class="anchor-link" href="#Resources"> </a>
</h3>
<ol>
<li>Documentation : <a href="https://learn.microsoft.com/en-us/power-bi/connect-data/service-real-time-streaming">https://learn.microsoft.com/en-us/power-bi/connect-data/service-real-time-streaming</a>
</li>
<li>Example datasets: <a href="https://github.com/reisanar/datasets">https://github.com/reisanar/datasets</a>
</li>
<li>Azure Open Datasets : <a href="https://github.com/Azure/OpenDatasetsNotebooks/">https://github.com/Azure/OpenDatasetsNotebooks/</a>
</li>
</ol>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="pawarbi/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/powerbi/pandas/python/api/streaming/dataset/2023/01/13/streaming-dataset-powerbi-pandas-python.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://pawarbi.github.io/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Data Analytics, Data Science Professional with expertise in Microsoft Data stack (Power BI, Azure)</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://twitter.com/pawarbi" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
