<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Random Number Generation in Power BI</h1><p class="page-description">Quick post on some things to keep in mind when using the RAND(), RANDBETWEEN() in Power BI to generate random numbers</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-06-03T00:00:00-05:00" itemprop="datePublished">
        Jun 3, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#powerbi">powerbi</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#DAX">DAX</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#M">M</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/pawarbi/blog/tree/master/_notebooks/2020-06-03-powerbi-random-numbers.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/pawarbi/blog/master?filepath=_notebooks%2F2020-06-03-powerbi-random-numbers.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/pawarbi/blog/blob/master/_notebooks/2020-06-03-powerbi-random-numbers.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Random-Number-Generation">Random Number Generation </a>
<ul>
<li class="toc-entry toc-h4"><a href="#What-are-random-numbers?">What are random numbers? </a></li>
<li class="toc-entry toc-h4"><a href="#How-to-generate-random-numbers?">How to generate random numbers? </a>
<ul>
<li class="toc-entry toc-h5"><a href="#Tip-1:-DAX-and-M-RandomBetween-behave-differently">Tip 1: DAX and M RandomBetween behave differently </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-2:-Multiple-Random-numbers-in-Power-Query">Tip 2: Multiple Random numbers in Power Query </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-3:-You-can-use-RAND()-to-create-decimal-random-numbers-between-two-numbers">Tip 3: You can use RAND() to create decimal random numbers between two numbers </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-4:-IMPORTANT-Be-careful-with-using-ROUND()-with-RAND()">Tip 4: IMPORTANT Be careful with using ROUND() with RAND() </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-5:-DAX-&-M-do-not-allow-random-seed">Tip 5: DAX &amp; M do not allow random seed </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-6:-Randomly-subsample-the-data-by-using-SAMPLE()-in-DAX">Tip 6: Randomly subsample the data by using SAMPLE() in DAX </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-7:-Randomly-generate-letters-or-sequence-of-letters">Tip 7: Randomly generate letters or sequence of letters </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-8:-Changing-column-type-to-decimal">Tip 8: Changing column type to decimal </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-9:-Limit-the-use-of-calculated-tables-and-columns-with-RAND()-and-RANDBETWEEN()">Tip 9: Limit the use of calculated tables and columns with RAND() and RANDBETWEEN() </a></li>
<li class="toc-entry toc-h5"><a href="#Tip-10:-Generating-random-dates">Tip 10: Generating random dates </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-03-powerbi-random-numbers.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Random-Number-Generation">
<a class="anchor" href="#Random-Number-Generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Random Number Generation<a class="anchor-link" href="#Random-Number-Generation"> </a>
</h1>
<p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/david-anderson-BedZDFNtxmw-unsplash.jpg" alt="Random Number" title="Credit: David Anderson, Unsplash"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quick post on creating random numbers in Power BI. While it's very easy to use, there are couple of things to keep in mind to get correct results. Typically the random numbers aren't needed in Power BI reports but I use them very often for simulations, statsitical functions and synthetic data generation.</p>
<h4 id="What-are-random-numbers?">
<a class="anchor" href="#What-are-random-numbers?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What are random numbers?<a class="anchor-link" href="#What-are-random-numbers?"> </a>
</h4>
<p>As series of values is said to contain random numbers if all the values have equal probability of occurence and there is no correlation, <em>i.e.</em> the numbers are uniformly distributed.</p>
<h4 id="How-to-generate-random-numbers?">
<a class="anchor" href="#How-to-generate-random-numbers?" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to generate random numbers?<a class="anchor-link" href="#How-to-generate-random-numbers?"> </a>
</h4>
<p>In DAX, you can use <code>RAND()</code> <a href="https://docs.microsoft.com/en-us/dax/rand-function-dax">function</a> to generate random numbers. Similarly, to generate random numbers <em>between</em> two numbers, <a href="https://docs.microsoft.com/en-us/dax/randbetween-function-dax">use</a> <code>RANDBETWEEN()</code>.</p>
<p>In Power Query, <code>List.Random()</code> creates a list of random numbers, while <code>Number.Random()</code> creates a single random number. You can add an index column <strong>before</strong> using the <code>Number.Random()</code> to get different random numbers on each row. You can delete the index column after the <code>Number.Random()</code> step. There isn't a <code>List.RandomBetween()</code> but <code>Number.RandomBetween()</code> can be used along with index column to generate numbers between two specified values.</p>
<h5 id="Tip-1:-DAX-and-M-RandomBetween-behave-differently">
<a class="anchor" href="#Tip-1:-DAX-and-M-RandomBetween-behave-differently" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 1: DAX and M RandomBetween behave differently<a class="anchor-link" href="#Tip-1:-DAX-and-M-RandomBetween-behave-differently"> </a>
</h5>
<p>If you generate random numbers between (1,100) using DAX <code>RANDOMBETWEEN(1,100)</code>, it will generate <em>integer/whole numbers</em> between (1,100) and will <strong>include</strong> numbers 1 and 100. In constrast to that, in Power Query <code>Number.RandomBetween(1,100)</code> will generate <em>decimal numbers</em> between 1 and 100 and will <strong>exclude</strong> 100. Thus, if you are using M and want to include 100, use <code>Number.RandomBetween(1,101)</code>.</p>
<p>To generate integer random values using M, first add an index column and then create a custom column using <code>Int16.From(Number.RandomBetween(1,100))</code>. This includes numbers 1 and 100.</p>
<h5 id="Tip-2:-Multiple-Random-numbers-in-Power-Query">
<a class="anchor" href="#Tip-2:-Multiple-Random-numbers-in-Power-Query" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 2: Multiple Random numbers in Power Query<a class="anchor-link" href="#Tip-2:-Multiple-Random-numbers-in-Power-Query"> </a>
</h5>
<p>To create multiple columns containing random numbers, add an index column <strong>each</strong> time <strong>before</strong> using the <code>Number.Random()</code>. You can delete the columns later.</p>
<p>You can alse wrap the step <strong>before</strong> the <code>Number.Random()</code> step with <code>Table.Buffer()</code> to generate different number on each row. For example, if you added a custom column in the step previous to adding random number column, your step would look like <code>Table.Buffer(Table.AddColumn(...))</code>. In this case you will not need to add an index column. If you need to add multiple random number columns, you can buffer the previous step each time. But be careful of the performance and transformation implications of <code>Table.Buffer()</code>. Read more abou it <a href="https://www.excelguru.ca/blog/2016/05/25/keep-the-most-recent-entry/">here</a>. Thanks to <a href="https://datachant.com/">Gil Raviv</a> for this tip..</p>
<h5 id="Tip-3:-You-can-use-RAND()-to-create-decimal-random-numbers-between-two-numbers">
<a class="anchor" href="#Tip-3:-You-can-use-RAND()-to-create-decimal-random-numbers-between-two-numbers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 3: You can use RAND() to create decimal random numbers between two numbers<a class="anchor-link" href="#Tip-3:-You-can-use-RAND()-to-create-decimal-random-numbers-between-two-numbers"> </a>
</h5>
<p>As <code>RANDBETWEEN()</code> creates integers, you can use <code>RAND()*N</code> to create decimal numbers between (0,N). In this case, the numbers <strong>will not include</strong> 0 and N.</p>
<p>Similarly, to generate decimal random numbers between (N1,N2) use <code>N1 + RAND() *(N2-N1)</code>. N1 &amp; N2 are not included.</p>
<p>You can divide <code>RANDBETWEEN()</code> by 10^i, to create numbers with 'i' decimal digits</p>
<h5 id="Tip-4:-IMPORTANT-Be-careful-with-using-ROUND()-with-RAND()">
<a class="anchor" href="#Tip-4:-IMPORTANT-Be-careful-with-using-ROUND()-with-RAND()" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 4: IMPORTANT Be careful with using ROUND() with RAND()<a class="anchor-link" href="#Tip-4:-IMPORTANT-Be-careful-with-using-ROUND()-with-RAND()"> </a>
</h5>
<p>As mentioned above, all random numbers should have equal probability of occurence otherwise it violates the uniform distribution assumption. If you use <code>ROUND()</code> with <code>RAND()</code> ( e.g.<code>ROUND(RAND()*50,0)</code>) to generate integers between 0 and 50, the end numbers will have half the probability of occurence compared to rest of the numbers. This is because numbers greater than or equal to 0.5 will be rounded to the next integer. e.g. 49.25 will be rounded down to 49 whereas 49.68 will be rounded up to 50. Thus, the end values have half the probability of occurence. The correct way is to use <code>INT()</code> i.e <code>INT(RAND()*50)</code>. While the error resulting from this will be minimal, it's better to use the correct formula when creating synthetic data to avoid bias.</p>
<h5 id="Tip-5:-DAX-&amp;-M-do-not-allow-random-seed">
<a class="anchor" href="#Tip-5:-DAX-&amp;-M-do-not-allow-random-seed" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 5: DAX &amp; M do not allow random seed<a class="anchor-link" href="#Tip-5:-DAX-&amp;-M-do-not-allow-random-seed"> </a>
</h5>
<p>In Python and R, you can specify the seed number to generate reproducible random numbers. Both in DAX &amp; M do not allow seed, so with each refresh new random numbers are generated. In many cases, this is not desirable. A work around for that is to generate random numbers in Power Query using M, indexing those and disabling the refresh for that query.</p>
<ul>
<li>
<p>Create an index column and random number column using</p>
<p><code>Table.FromColumns( { {1..n_samples}, List.Random(n_samples)}, {"Index", "NRandom"} )</code></p>
<p>where n_samples &gt;&gt;&gt; number of random values you need. For example, if you are going to need 3 sets of random numbers 1000 each, use n_samples &gt;&gt; 3000 ,say 5000.</p>
</li>
<li>Uncheck "Include in report refresh" for that query </li>
<li>Now you can use this list by using <code>FILETR()</code> in DAX by passing <code>Table[Index] &lt; 1001</code> and so forth </li>
</ul>
<h5 id="Tip-6:-Randomly-subsample-the-data-by-using-SAMPLE()-in-DAX">
<a class="anchor" href="#Tip-6:-Randomly-subsample-the-data-by-using-SAMPLE()-in-DAX" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 6: Randomly subsample the data by using SAMPLE() in DAX<a class="anchor-link" href="#Tip-6:-Randomly-subsample-the-data-by-using-SAMPLE()-in-DAX"> </a>
</h5>
<p>I use this often to check robsutness/sensitivity of the simulation results with respect to the features used. For example, some columns may show correlaton or importance when used entirely but when sub-sampled may or may not.</p>
<p>To sample a column, use <code>SAMPLE(sample_size, 'Table', 'Table'[Column])</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://www.youtube.com/channel/UCJ7UhloHSA4wAqPzyi6TOkw">Ruth</a> provides a good overview of the <code>SAMPLE()</code> function below:

</p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/ULQz5PDbgaE" frameborder="0" allowfullscreen=""></iframe>
</center>


</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tip-7:-Randomly-generate-letters-or-sequence-of-letters">
<a class="anchor" href="#Tip-7:-Randomly-generate-letters-or-sequence-of-letters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 7: Randomly generate letters or sequence of letters<a class="anchor-link" href="#Tip-7:-Randomly-generate-letters-or-sequence-of-letters"> </a>
</h5>
<p>You can use <code>UNICHAR()</code> and <code>RANDBETWEEN()</code> to generate random letters</p>
<p>To generate upper case latters: <code>UNICHAR(RANDBETWEEN(65,90)</code></p>
<p>To generate lower case latters: <code>UNICHAR(RANDBETWEEN(97,122)</code></p>
<p>To generate upper &amp; lower case latters: <code>UNICHAR(RANDBETWEEN(97,122) &amp; UNICHAR(RANDBETWEEN(65,90)</code></p>
<p>In addition you can nest them with <code>RANDBETWEEN()</code> to generate a random words, passwords, symbols etc. For a list of unicode chart, <a href="https://www.ssec.wisc.edu/~tomw/java/unicode.html#x0000">see this</a></p>
<p>Similarly, to generate characters using M, first create an index column and then use:</p>
<p><code>Character.FromNumber(Int16.From(Number.RandomBetween(65,90)))</code> for upper case letters. Thanks to <a href="https://twitter.com/notaboutthecell">Alex Powers</a> for the tip.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tip-8:-Changing-column-type-to-decimal">
<a class="anchor" href="#Tip-8:-Changing-column-type-to-decimal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 8: Changing column type to decimal<a class="anchor-link" href="#Tip-8:-Changing-column-type-to-decimal"> </a>
</h5>
<p>When you create the custom column with random numbers using <code>Number.Random()</code> in Power Query, it will be mixed type (123/ABC). If you convert it to Decimal, randomness is lost and all the numbers in the column will be the same. Solution to that is just add another index column ! You can always delete it later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tip-9:-Limit-the-use-of-calculated-tables-and-columns-with-RAND()-and-RANDBETWEEN()">
<a class="anchor" href="#Tip-9:-Limit-the-use-of-calculated-tables-and-columns-with-RAND()-and-RANDBETWEEN()" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 9: Limit the use of calculated tables and columns with RAND() and RANDBETWEEN()<a class="anchor-link" href="#Tip-9:-Limit-the-use-of-calculated-tables-and-columns-with-RAND()-and-RANDBETWEEN()"> </a>
</h5>
<p>The DAX Maestro Marco Russo <a href="https://www.sqlbi.com/blog/marco/2022/04/30/about-waiting-time-for-power-bi-desktop-to-open/">has a blog on "volatile" DAX functions</a>. These are the DAX functions that return differrent values when the model is refreshed. Using too many of these volatile functions in the model can cause slower refreshes. Use <code>RAND()</code> AND <code>RANDBETWEEN()</code> but use them judicously and be aware of the potential performance impact.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tip-10:-Generating-random-dates">
<a class="anchor" href="#Tip-10:-Generating-random-dates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tip 10: Generating random dates<a class="anchor-link" href="#Tip-10:-Generating-random-dates"> </a>
</h5>
<p>To generate random dates, we can convert the random numbers generated by <code>RAND()</code> AND <code>RANDBETWEEN()</code> to date. For example, to generate random dates between years 2000 and 2030, we can use <code>CONVERT(RANDBETWEEN(36526,45658), DATETIME)</code>. Note that in DAX 0 is <code>12/30/1899</code>, so just calculate accordingly. In Power Query, the equivalent would be <code>Date.From (Number.RandomBetween(36526,45658))</code>.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="pawarbi/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/powerbi/dax/m/2020/06/03/powerbi-random-numbers.html" hidden></a>
</article>