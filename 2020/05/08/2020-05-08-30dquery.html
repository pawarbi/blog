<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-08-30dquery.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Challenge-7">Challenge 7<a class="anchor-link" href="#Challenge-7"> </a></h2><p><a href="https://itsnotaboutthecell.com/about/">Alex Powers</a> is running a Power Query Challenge to write M code that can fold. 
Read more about Query Folding <a href="https://docs.microsoft.com/en-us/power-query/power-query-folding">here</a></p>
<p>Below is Alex's video. You can find out more challenges on his <a href="https://www.youtube.com/channel/UCfz8kQWzTkXU0erBLjdc4dg">YouTube channel</a></p>
<p>I wanted to write this one on the blog because it's a useful recipe that I can see myself using in the future.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/XgRtTA-GkxE" frameborder="0" allowfullscreen=""></iframe>
</center>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="My-Solution">My Solution<a class="anchor-link" href="#My-Solution"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Get a list of column names with <code>Table.ColumnNames(..)</code></li>
<li>Convert the list to table and filter out the names with "Dim" in them by <code>Text.Contains(..)</code></li>
<li>Pass the filtered list to <code>Table.SelectColumns(..)</code></li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">let</span>
  <span class="o">//</span> <span class="n">Database</span>
  <span class="n">Source2</span>
    <span class="o">=</span> <span class="n">Sql</span><span class="o">.</span><span class="n">Databases</span><span class="p">(</span>
      <span class="s2">&quot;localhost&quot;</span>
    <span class="p">),</span>
  <span class="n">AdventureWorksDW2017</span>
    <span class="o">=</span> <span class="n">Source2</span><span class="p">{[</span><span class="n">Name</span>
      <span class="o">=</span> <span class="s2">&quot;AdventureWorksDW2017&quot;</span><span class="p">]}[</span><span class="n">Data</span><span class="p">],</span>
  <span class="n">dbo_DimEmployee</span>
    <span class="o">=</span> <span class="n">AdventureWorksDW2017</span><span class="p">{[</span>
      <span class="n">Schema</span> <span class="o">=</span> <span class="s2">&quot;dbo&quot;</span><span class="p">,</span> 
      <span class="n">Item</span>
        <span class="o">=</span> <span class="s2">&quot;DimEmployee&quot;</span>
    <span class="p">]}[</span><span class="n">Data</span><span class="p">],</span>
  <span class="o">//</span> <span class="n">Get</span> <span class="n">Column</span> <span class="n">Names</span>
  <span class="n">cols</span>
    <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">ColumnNames</span><span class="p">(</span>
      <span class="n">dbo_DimEmployee</span>
    <span class="p">),</span>
  <span class="o">//</span> <span class="n">Convert</span> <span class="n">to</span> <span class="n">Table</span> <span class="ow">and</span> <span class="nb">filter</span> <span class="n">out</span> <span class="n">names</span> <span class="n">that</span> <span class="n">contain</span> <span class="s2">&quot;Dim</span>
  <span class="n">to_table</span>
    <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">FromList</span><span class="p">(</span>
      <span class="n">cols</span>
    <span class="p">),</span>
  <span class="nb">filter</span>
    <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">SelectRows</span><span class="p">(</span>
      <span class="n">to_table</span><span class="p">,</span> 
      <span class="n">each</span> 
        <span class="ow">not</span> <span class="n">Text</span><span class="o">.</span><span class="n">Contains</span><span class="p">(</span>
        <span class="p">[</span><span class="n">Column1</span><span class="p">],</span> 
        <span class="s2">&quot;Dim&quot;</span>
      <span class="p">)</span>
    <span class="p">),</span>
  <span class="n">final_cols</span>
    <span class="o">=</span> <span class="nb">filter</span><span class="p">[</span><span class="n">Column1</span><span class="p">],</span>
  <span class="o">//</span> <span class="n">Select</span> <span class="n">Columns</span>
  <span class="n">DimEmployee_table</span>
    <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">SelectColumns</span><span class="p">(</span>
      <span class="n">dbo_DimEmployee</span><span class="p">,</span> 
      <span class="n">final_cols</span>
    <span class="p">)</span>
<span class="ow">in</span>
  <span class="n">DimEmployee_table</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Query-is-foldable">Query is foldable<a class="anchor-link" href="#Query-is-foldable"> </a></h4><p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/query7.jpg" alt="" /></p>

</div>
</div>
</div>
</div>

