<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-07-powerbi-30dquery07.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Challenge-7">Challenge 7<a class="anchor-link" href="#Challenge-7"> </a></h2><p><a href="https://itsnotaboutthecell.com/about/">Alex Powers</a> is running a Power Query Challenge to write M code that can fold. 
Read more about Query Folding <a href="https://docs.microsoft.com/en-us/power-query/power-query-folding">here</a></p>
<p>Below is Alex's video. You can find out more challenges on his <a href="https://www.youtube.com/channel/UCfz8kQWzTkXU0erBLjdc4dg">YouTube channel</a></p>
<p>I wanted to write this one on the blog because it's a useful recipe that I can see myself using in the future.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/XgRtTA-GkxE" frameborder="0" allowfullscreen=""></iframe>
</center>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="My-Solution">My Solution<a class="anchor-link" href="#My-Solution"> </a></h3><ol>
<li>Get a list of column names with <code>Table.ColumnNames(..)</code></li>
<li>Convert the list to table and filter out the names with "Dim" in them by <code>Text.Contains(..)</code></li>
<li>Pass the filtered list to <code>Table.SelectColumns(..)</code></li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>let
    // Database
    Source2              = Sql.Databases("localhost"),
    AdventureWorksDW2017 = Source2{[Name = "AdventureWorksDW2017"]}[Data],
    dbo_DimEmployee
        = AdventureWorksDW2017{[Schema = "dbo", Item = "DimEmployee"]}[Data],
    // Get Column Names
    cols                 = Table.ColumnNames(dbo_DimEmployee),
    // Convert to Table and filter out names that contain "Dim
    to_table             = Table.FromList(cols),
    filter               = Table.SelectRows(
        to_table, 
        each not Text.Contains([Column1], "Dim")
    ),
    final_cols           = filter[Column1],
    // Select Columns
    DimEmployee_table    = Table.SelectColumns(dbo_DimEmployee, final_cols)
in
    DimEmployee_table</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Query-is-foldable">Query is foldable<a class="anchor-link" href="#Query-is-foldable"> </a></h4><p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/query7.jpg" alt="" /></p>

</div>
</div>
</div>
</div>

