<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook | Sandeep Pawar</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook" />
<meta property="og:description" content="In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook" />
<link rel="canonical" href="https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html" />
<meta property="og:url" content="https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html" />
<meta property="og:site_name" content="Sandeep Pawar" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-11T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html"},"url":"https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html","headline":"Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook","dateModified":"2020-12-11T00:00:00-06:00","datePublished":"2020-12-11T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pawarbi.github.io/blog/feed.xml" title="Sandeep Pawar" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-164557532-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook | Sandeep Pawar</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook" />
<meta property="og:description" content="In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook" />
<link rel="canonical" href="https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html" />
<meta property="og:url" content="https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html" />
<meta property="og:site_name" content="Sandeep Pawar" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-11T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html"},"url":"https://pawarbi.github.io/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html","headline":"Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook","dateModified":"2020-12-11T00:00:00-06:00","datePublished":"2020-12-11T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://pawarbi.github.io/blog/feed.xml" title="Sandeep Pawar" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-164557532-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Sandeep Pawar</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Accessing Power BI Datasets via XMLA Endpoint in Python Jupyter Notebook</h1><p class="page-description">In this blog post I show how you can use Python to access datasets published to Power BI service using Python in Jupyter Notebook</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-11T00:00:00-06:00" itemprop="datePublished">
        Dec 11, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#PPU">PPU</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#XMLA">XMLA</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#PowerBI_Premium">PowerBI_Premium</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Premium">Premium</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Jupyter_Notebook">Jupyter_Notebook</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/pawarbi/blog/tree/master/_notebooks/2020-12-11-Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/pawarbi/blog/master?filepath=_notebooks%2F2020-12-11-Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/pawarbi/blog/blob/master/_notebooks/2020-12-11-Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Connect-to-Premium-Workspace">Connect to Premium Workspace </a></li>
<li class="toc-entry toc-h2"><a href="#Access-Datasets">Access Datasets </a></li>
<li class="toc-entry toc-h2"><a href="#Access-Measures">Access Measures </a></li>
<li class="toc-entry toc-h2"><a href="#References:">References: </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-12-11-Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Power BI recently announced availability of a new license <a href="https://powerbi.microsoft.com/en-us/blog/power-bi-premium-per-user-public-preview-now-available/">'Premium Per User'</a> which will allow small to medium size companies to access Premium features at a lower price point (as of 12/11/2020 price has not been published) . I was given a priority access to it and have been exploring all the premium features for the last few weeks. One of the key benefits of Premium is the ability to consume published datasets via XMLA endpoint. Instead of me describing it, you can read Microsoft's documentation for detailed description <a href="https://docs.microsoft.com/en-us/power-bi/admin/service-premium-connect-tools">here</a>.</p>
<p>To use XMLA endpoint, you will need to have a Premium workspace and enable the 'XMLA Endpoint' in capacity settings.</p>
<p>Capacity Settings &gt; Power BI Premium &gt; Workloads &gt; XMLA Endpoint</p>
<p><img src="https://docs.microsoft.com/en-us/power-bi/admin/media/service-premium-connect-tools/xmla-endpoint-enable.png" alt="image"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this blog post I will show how to setup connection to the XMLA endpoint and access Power BI datasets &amp; measures within those datasets using Python in a Jupyter notebook. This blog post is written in a Jupyter notebook. I use Jupyter notebooks for data exploration, visualization and building machine learning models. Ability to consume published datasets in a notebook will be immensely helpful in my own workflow.</p>
<p>I took inspiration from <a href="https://www.linkedin.com/in/davideldersveld/">David Elderveld's</a> amazing <a href="https://dataveld.com/2020/08/17/jupyter-as-an-external-tool-for-power-bi-desktop-python-part-4/">4-part blogposts</a> on <em>'Jupyter as an External Tool for Power BI Desktop'</em>. It really opened up lot of options that I didn't know existed, thanks David! I highly encourage you to read all the four posts to learn more about using Python with Power BI.</p>
<p>Secondly, none of this would be possible without the <code>python-ssas</code> <a href="https://github.com/yehoshuadimarsky/python-ssas/">module</a> by Josh Dimarsky which enables TOM connection to Analysis Services.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get started, you will need three things:</p>
<ul>
<li>install the <a href="https://github.com/pythonnet/pythonnet">pythonnet</a> library (<code>pip install pythonnet</code>)</li>
<li>Make sure you have <code>Microsoft.AnalysisServices.Tabular.dll</code> and <code>Microsoft.AnalysisServices.AdomdClient.dll</code> dlls. If you use Excel, Power BI, you will most likley already have them. As Josh mentions in his documentation, they are usually installed in <code>C:\Windows\Microsoft.NET\assembly\GAC_MSIL</code>
</li>
<li>copy the <code>ssas_api.py</code> file from <a href="https://github.com/yehoshuadimarsky/python-ssas/blob/master/ssas_api.py">here</a> and save it in your Python libraries folder or Jupyter working directory.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">ssas_api</span> <span class="k">as</span> <span class="nn">ssas</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Connect-to-Premium-Workspace">
<a class="anchor" href="#Connect-to-Premium-Workspace" aria-hidden="true"><span class="octicon octicon-link"></span></a>Connect to Premium Workspace<a class="anchor-link" href="#Connect-to-Premium-Workspace"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we want to connect to our Power BI service account &amp; the Premium workspace. You will need to find the workspace connection string URL. It will be in this format <code>powerbi://api.powerbi.com/v1.0/[tenant name]/[workspace name]</code>. You can obtain it from your workspace settings (see below)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First go to your Premium Workspace and click on Settings. Notice that I have three datasets in this workspace, viz Dataset1, dataset2 and dataset2_2.</p>
<p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/xmla1.jpg" alt="ws_settings"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, copy the server address from Workspace Connection:</p>
<p><img src="https://raw.githubusercontent.com/pawarbi/blog/master/images/xmla2.jpg" alt="connection"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create variables for your tenant username and password</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">server</span> <span class="o">=</span> <span class="s1">'workspace_connection_from_above'</span>

<span class="n">username</span> <span class="o">=</span> <span class="s1">'name@email.com'</span>

<span class="n">password</span> <span class="o">=</span> <span class="s1">'password'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Setup connection string by specifying the server name, username &amp; password. Note that I have left the database name (<code>db_name</code>) blank here because I am assuming that we don't know the names of the datasets that are available in this workspace. We will explore the workspace and get a list of all the datasets. If you already know the dataset name, you can enter it between the single quotations.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conn1</span> <span class="o">=</span> <span class="n">ssas</span><span class="o">.</span><span class="n">set_conn_string</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="n">server</span><span class="p">,</span>
    <span class="n">db_name</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">password</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import libraries for <a href="https://docs.microsoft.com/en-us/analysis-services/tom/introduction-to-the-tabular-object-model-tom-in-analysis-services-amo?view=asallproducts-allversions">Tabular Object Model</a> (TOM) and setup the TOM server. As long as your username and password are valid, you will connect to your workspace using TOM. If it fails, it means either your credentials are incorrect or you do not have access to the workspace. You will <em>not</em> be prompted for interactive authentication.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">global</span> <span class="n">System</span><span class="p">,</span> <span class="n">DataTable</span><span class="p">,</span> <span class="n">AMO</span><span class="p">,</span> <span class="n">ADOMD</span>

<span class="kn">import</span> <span class="nn">System</span>
<span class="kn">from</span> <span class="nn">System.Data</span> <span class="kn">import</span> <span class="n">DataTable</span>
<span class="kn">import</span> <span class="nn">Microsoft.AnalysisServices.Tabular</span> <span class="k">as</span> <span class="nn">TOM</span>
<span class="kn">import</span> <span class="nn">Microsoft.AnalysisServices.AdomdClient</span> <span class="k">as</span> <span class="nn">ADOMD</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">TOMServer</span> <span class="o">=</span> <span class="n">TOM</span><span class="o">.</span><span class="n">Server</span><span class="p">()</span>
    <span class="n">TOMServer</span><span class="o">.</span><span class="n">Connect</span><span class="p">(</span><span class="n">conn1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Connection to Workspace Successful !"</span><span class="p">)</span>
    
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Connection to Workspace Failed"</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Connection to Workspace Successful !
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Access-Datasets">
<a class="anchor" href="#Access-Datasets" aria-hidden="true"><span class="octicon octicon-link"></span></a>Access Datasets<a class="anchor-link" href="#Access-Datasets"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now get a list of all the avaible datasets in this workspace and their metadata such as compatibility level, database id, size in megabytes, creation date and last update date.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Dataset_Name'</span><span class="p">,</span> <span class="s1">'Compatibility'</span><span class="p">,</span> <span class="s1">'ID'</span><span class="p">,</span> <span class="s1">'Size_MB'</span><span class="p">,</span><span class="s1">'Created_Date'</span><span class="p">,</span><span class="s1">'Last_Update'</span> <span class="p">])</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">TOMServer</span><span class="o">.</span><span class="n">Databases</span><span class="p">:</span>
    
          
    <span class="n">datasets</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'Dataset_Name'</span> <span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> 
                     <span class="s1">'Compatibility'</span><span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">CompatibilityLevel</span><span class="p">,</span>
                     <span class="s1">'Created_Date'</span> <span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">CreatedTimestamp</span><span class="p">,</span>
                     <span class="s1">'ID'</span>           <span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                     <span class="s1">'Last_Update'</span>  <span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">LastUpdate</span><span class="p">,</span>
                     <span class="s1">'Size_MB'</span>      <span class="p">:(</span><span class="n">item</span><span class="o">.</span><span class="n">EstimatedSize</span><span class="o">*</span><span class="mf">1e-06</span><span class="p">)</span>    <span class="p">},</span>
                     <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">datasets</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dataset_Name</th>
      <th>Compatibility</th>
      <th>ID</th>
      <th>Size_MB</th>
      <th>Created_Date</th>
      <th>Last_Update</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dataset1</td>
      <td>1465</td>
      <td>a28e52a8-d6b3-4b5c-8e61-e107fbd52748</td>
      <td>1.916094</td>
      <td>8/21/2018 3:34:53 PM</td>
      <td>12/11/2020 11:24:21 AM</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dataset2_2</td>
      <td>1520</td>
      <td>a93244fe-860d-45c2-9d36-b44fb284c54d</td>
      <td>0.454222</td>
      <td>12/11/2020 10:01:57 AM</td>
      <td>12/11/2020 11:20:50 AM</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I have three datasets in this workspace but I only see 2! dataset2 and dataset2_2 are identical except dataset2 was created by uploading the csv file to the worspace while the other two datasets were published to the workspace from Power BI Desktop. Also note that their compatibility levels are different. Dataset1 was published with the old version of Power BI Desktop with 'Enhanced Metadata' option turned off that's why its compatibility level is not 1520.  Since <a href="https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-enhanced-dataset-metadata">September 2020 release</a>, Power BI Desktop automatically converts the datasets to Enhanced Metadata.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's choose the dataset we want to connect to. In this case I want to access <code>dataset2_2</code>. I will copy the database id from the <code>ID</code> column from the above table. Then we will find the names of all the tables that are available in that dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">TOMServer</span><span class="o">.</span><span class="n">Databases</span><span class="p">[</span><span class="s1">'a93244fe-860d-45c2-9d36-b44fb284c54d'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">Tables</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dataset2
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <code>dataset2_2</code> dataset, the only available table is <code>dataset2</code>. Let's connect to this table. We will create a new connection string by specifying the <code>db_name</code> this time.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conn2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ssas</span><span class="o">.</span><span class="n">set_conn_string</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="n">server</span><span class="p">,</span>
    <span class="n">db_name</span><span class="o">=</span><span class="s1">'dataset2_2'</span><span class="p">,</span>
    <span class="n">username</span> <span class="o">=</span> <span class="s1">'name@email.com'</span><span class="p">,</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s1">'password'</span>
 <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can write any valid DAX query against this table and get the results back as a Pandas dataframe.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dax_string</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">    //Write your DAX Query here</span>
<span class="s1">    EVALUATE</span>
<span class="s1">    dataset2</span>
<span class="s1">    '''</span>

<span class="n">df_dataset2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ssas</span>
               <span class="o">.</span><span class="n">get_DAX</span><span class="p">(</span>
                   <span class="n">connection_string</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> 
                   <span class="n">dax_string</span><span class="o">=</span><span class="n">dax_string</span><span class="p">)</span>
               
              <span class="p">)</span>

<span class="n">df_dataset2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset2[vendorID]</th>
      <th>dataset2[passengerCount]</th>
      <th>dataset2[tripDistance]</th>
      <th>dataset2[hour_of_day]</th>
      <th>dataset2[day_of_week]</th>
      <th>dataset2[day_of_month]</th>
      <th>dataset2[month_num]</th>
      <th>dataset2[normalizeHolidayName]</th>
      <th>dataset2[isPaidTimeOff]</th>
      <th>dataset2[snowDepth]</th>
      <th>dataset2[precipTime]</th>
      <th>dataset2[precipDepth]</th>
      <th>dataset2[temperature]</th>
      <th>dataset2[totalAmount]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>1</td>
      <td>2.62</td>
      <td>2</td>
      <td>6</td>
      <td>19</td>
      <td>6</td>
      <td>None</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>23.116071</td>
      <td>11.80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>0.42</td>
      <td>17</td>
      <td>6</td>
      <td>19</td>
      <td>6</td>
      <td>None</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>23.116071</td>
      <td>4.30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>1.78</td>
      <td>18</td>
      <td>6</td>
      <td>19</td>
      <td>6</td>
      <td>None</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>23.116071</td>
      <td>12.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>1.26</td>
      <td>16</td>
      <td>6</td>
      <td>19</td>
      <td>6</td>
      <td>None</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>23.116071</td>
      <td>9.36</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>1</td>
      <td>2.37</td>
      <td>22</td>
      <td>6</td>
      <td>19</td>
      <td>6</td>
      <td>None</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>23.116071</td>
      <td>10.80</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df_dataset2</span><span class="p">[</span><span class="s1">'dataset2[totalAmount]'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:xlabel='dataset2[totalAmount]'&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Access-Measures">
<a class="anchor" href="#Access-Measures" aria-hidden="true"><span class="octicon octicon-link"></span></a>Access Measures<a class="anchor-link" href="#Access-Measures"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also get a list of all the measures and their DAX expressions. As seen below, in this table we have only one measure called <code>totalAmount average per vendorID</code> with its DAX.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">Tables</span><span class="o">.</span><span class="n">Find</span><span class="p">(</span><span class="s1">'dataset2'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">Measures</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">measure</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="s2">":</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">measure</span><span class="o">.</span><span class="n">Expression</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>totalAmount average per vendorID :
 
AVERAGEX(
	KEEPFILTERS(VALUES('dataset2'[vendorID])),
	CALCULATE(SUM('dataset2'[totalAmount]))
)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on <a href="https://docs.microsoft.com/en-us/power-bi/admin/service-premium-connect-tools">this</a> Microsoft documentation, I was under the impression that only the datasets with Compatibility level 1500 or higher could be accessed via XMLA. That's not the case. <code>Dataset1</code> has a compatibility of 1465 and can still be accessed via XMLA endpoint as seen below.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conn3</span> <span class="o">=</span> <span class="p">(</span><span class="n">ssas</span><span class="o">.</span><span class="n">set_conn_string</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="n">server</span><span class="p">,</span>
    <span class="n">db_name</span><span class="o">=</span><span class="s1">'Dataset1'</span><span class="p">,</span>
    <span class="n">username</span> <span class="o">=</span> <span class="s1">'name@email.com'</span><span class="p">,</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s1">'password'</span>
 <span class="p">))</span>

<span class="n">dax_string2</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">    //Write your DAX Query here</span>
<span class="s1">    EVALUATE</span>
<span class="s1">    KeyInfluencers_Predictors</span>
<span class="s1">    '''</span>

<span class="n">df_dataset1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ssas</span>
               <span class="o">.</span><span class="n">get_DAX</span><span class="p">(</span>
                   <span class="n">connection_string</span><span class="o">=</span><span class="n">conn3</span><span class="p">,</span> 
                   <span class="n">dax_string</span><span class="o">=</span><span class="n">dax_string2</span><span class="p">)</span>
               
              <span class="p">)</span>

<span class="n">df_dataset1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KeyInfluencers_Predictors[Feature Name]</th>
      <th>KeyInfluencers_Predictors[Feature Type]</th>
      <th>KeyInfluencers_Predictors[Feature Importance]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>col6</td>
      <td>Numeric</td>
      <td>0.417869</td>
    </tr>
    <tr>
      <th>1</th>
      <td>col0</td>
      <td>Numeric</td>
      <td>0.257106</td>
    </tr>
    <tr>
      <th>2</th>
      <td>col4</td>
      <td>Numeric</td>
      <td>0.106939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>col3</td>
      <td>Numeric</td>
      <td>0.090845</td>
    </tr>
    <tr>
      <th>4</th>
      <td>col1</td>
      <td>Numeric</td>
      <td>0.066334</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Datasets in Power BI service can currently be accessed via number of different tools (SSDT, SSMS, PowerShell, Tabular Editor, DAX Studio, ALM Toolkit) which are all database modeling tools. But Data Scientists now can easily access the datasets for exploring the data and building machine learning models in Jupyter Notebook or VSCode using Python.</p>
<p>This method can also be used to export multiple refreshed dataset(s) on a schedule and on demand.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are still few things I am not sure about and need to explore more.</p>
<ul>
<li>Can I use service principal, key etc so I don't have to write username/password in my code</li>
<li>How to write back, create dataset using Python and push it to the workspace</li>
<li>Can I create/modify measures?</li>
<li>What are the limitations ? </li>
</ul>
<p>Please feel free to post your comments below or reach out to me if you find any errors or have suggestions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References:">
<a class="anchor" href="#References:" aria-hidden="true"><span class="octicon octicon-link"></span></a>References:<a class="anchor-link" href="#References:"> </a>
</h2>
<ul>
<li><a href="https://dataveld.com/2020/07/20/python-as-an-external-tool-for-power-bi-desktop-part-1/">https://dataveld.com/2020/07/20/python-as-an-external-tool-for-power-bi-desktop-part-1/</a></li>
<li><a href="https://powerbi.microsoft.com/en-us/blog/power-bi-premium-per-user-public-preview-now-available/">https://powerbi.microsoft.com/en-us/blog/power-bi-premium-per-user-public-preview-now-available/</a></li>
<li><a href="https://github.com/yehoshuadimarsky/python-ssas/">https://github.com/yehoshuadimarsky/python-ssas/</a></li>
<li><a href="https://docs.microsoft.com/en-us/power-bi/admin/service-premium-connect-tools">https://docs.microsoft.com/en-us/power-bi/admin/service-premium-connect-tools</a></li>
<li><a href="https://docs.microsoft.com/en-us/analysis-services/tom/introduction-to-the-tabular-object-model-tom-in-analysis-services-amo?view=asallproducts-allversions">https://docs.microsoft.com/en-us/analysis-services/tom/introduction-to-the-tabular-object-model-tom-in-analysis-services-amo?view=asallproducts-allversions</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices.tabular.measure?view=analysisservices-dotnet">https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices.tabular.measure?view=analysisservices-dotnet</a></li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="pawarbi/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/ppu/xmla/powerbi_premium/premium/python/jupyter_notebook/2020/12/11/Accessing-Power-BI-Datasets-via-XMLA-Endpoint-in-Python-Jupyter-Notebook.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Power BI, ML, Python, R, Azure ML</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pawarbi" title="pawarbi"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/pawarbi" title="pawarbi"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
